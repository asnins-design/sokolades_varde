<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Šokolādes Varde</title>

<style>
body {
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 30px auto;
}

.item-row {
    margin: 8px 0;
    display: flex;
    align-items: center;
}

.item-row img {
    width: 40px;
    height: 40px;
    margin-right: 10px;
}

.item-name {
    flex: 1;
}

button {
    margin-left: 8px;
}

#basket {
    margin-top: 15px;
    padding: 10px;
    border: 1px solid #ccc;
    min-height: 80px;
}

#total {
    margin-top: 15px;
    font-weight: bold;
}
</style>
</head>

<body>

<h2>Šokolādes vardes kase</h2>

<div id="items"></div>

<h3>Grozā šobrīd:</h3>
<div id="basket"></div>

<div id="total">Kopā jāmaksā: 0G 0S 0K</div>

<button onclick="checkout()">PIRKT</button>
<button onclick="resetBasket()">Jauns pirkums</button>

<script>
// Currency system
const KNUTAS_IN_SIRPS = 5;
const SIRPS_IN_GALEON = 5;
const KNUTAS_IN_GALEON = KNUTAS_IN_SIRPS * SIRPS_IN_GALEON;

function toKnutas(g=0,s=0,k=0){
    return g*KNUTAS_IN_GALEON + s*KNUTAS_IN_SIRPS + k;
}

function fromKnutas(total){
    const g = Math.floor(total / KNUTAS_IN_GALEON);
    const remainder = total % KNUTAS_IN_GALEON;
    const s = Math.floor(remainder / KNUTAS_IN_SIRPS);
    const k = remainder % KNUTAS_IN_SIRPS;
    return {g,s,k};
}

function formatMoney(knutas){
    const m = fromKnutas(knutas);
    return `${m.g}G ${m.s}S ${m.k}K`;
}

// Items WITH images
const items = {
    "Strupa apmetņu striķi": { price: toKnutas(0,2,3), image: "images/pirmais.avif" },
    "Sviedene": { price: toKnutas(0,0,4), image: "images/otrais.avif" },
    "Hagrida Zizlis": { price: toKnutas(0,1,2), image: "images/tresais.png" },
    "Šokolādes varde": { price: toKnutas(0,3,0), image: "images/ceturtais.png" },
    "Mājas elfs": { price: toKnutas(1,2,3), image: "images/piektais.png" }
};

let basket = {};
let totalKnutas = 0;

for(let name in items){
    basket[name] = 0;
}

const itemsDiv = document.getElementById("items");

for(let name in items){
    const row = document.createElement("div");
    row.className = "item-row";

    const img = document.createElement("img");
    img.src = items[name].image;

    const label = document.createElement("div");
    label.className = "item-name";
    label.textContent = `${name} (${formatMoney(items[name].price)})`;

    const addBtn = document.createElement("button");
    addBtn.textContent = "+";
    addBtn.onclick = () => addItem(name);

    const removeBtn = document.createElement("button");
    removeBtn.textContent = "-";
    removeBtn.onclick = () => removeItem(name);

    row.appendChild(img);
    row.appendChild(label);
    row.appendChild(addBtn);
    row.appendChild(removeBtn);

    itemsDiv.appendChild(row);
}

function addItem(name){
    basket[name]++;
    totalKnutas += items[name].price;
    updateDisplay();
}

function removeItem(name){
    if(basket[name] > 0){
        basket[name]--;
        totalKnutas -= items[name].price;
        updateDisplay();
    }
}

function updateDisplay(){
    const basketDiv = document.getElementById("basket");
    basketDiv.innerHTML = "";

    for(let name in basket){
        if(basket[name] > 0){
            const line = document.createElement("div");
            line.textContent = `${name} x${basket[name]}`;
            basketDiv.appendChild(line);
        }
    }

    document.getElementById("total").textContent =
        "Kopā jāmaksā: " + formatMoney(totalKnutas);
}

function checkout(){
    if(totalKnutas === 0){
        alert("Nav izvēlēti produkti!");
        return;
    }

    let receipt = "Čeks\n\n";

    for(let name in basket){
        if(basket[name] > 0){
            const lineTotal = basket[name] * items[name].price;
            receipt += `${name} x${basket[name]} - ${formatMoney(lineTotal)}\n`;
        }
    }

    receipt += "\nKOPĀ: " + formatMoney(totalKnutas);

    alert(receipt);
}

function resetBasket(){
    totalKnutas = 0;
    for(let name in basket){
        basket[name] = 0;
    }
    updateDisplay();
}
</script>

</body>
</html>
